# PKI 개념

Istio 보안에서 제공하는 인증서 관리방법, 인증, 권한을 이해하기 위해서 PKI \(Public Key Infrastructure\) 공개키 암호화 시스템에 대한 기본적인 암호학에 대한 이해가 필요합니다. 



### 대칭키 암호화 \(Symmetric Key Algorithm\)

PKI 공개키 기반의 암호화 알고리즘이 나오기 전에 전통적인 암호화 기법으로는 대칭키 암호화 방법이 있습니다. 대칭키는 송신자와 수신자가 동일한 키, 즉 대칭키를 사전에 공유합니다. 송신자는 중요 정보가 담긴 평문\(Plain Text\) 을 대칭키로 암호화하여 수신자에게 전송하고, 수신자는 대칭키로 복호화하여 평문의 내용을 확인할 수 있습니다.

![](../.gitbook/assets/image%20%283%29.png)

이러한 대칭키의 근본적인 문제는 송/수신자가 동일한 대칭키를 암호화 하기 전에 미리 공유해야 한다는 것이고, 대칭키가 별도의 안전한 보안 채널을 통해서 공유되지 않을 경우 악의적인 사용자나 해커에 의해 노출될 수 있습니다. 이 경우 해당 대칭키로 암호화된 모든 평문은 복호화 되어 중요 정보가 노출될 수 있습니다. 또한 하나의 대칭키를 오랜시간 동안 사용하는 것은 보안상 취약하므로 이에 대한 갱신이 필요한데, 대칭키 구조상 쉽게 변경, 교체하기 어려운 구조적인 한계점을 가지고 있습니다. 이러한 문제를 근본적으로 해결하고 암호키를 송/수신자가 안전하게 공유하기 위한 방법으로 비대칭 암호화 알고리즘이 나오게 되었습니다.

### 비대칭 암호화 \(Asymmetric Algorithm\)

과거 대칭키 암호화 알고리즘을 이용하여 암호화를 진행할 경우 암호키 뿐만 아니라 암호화 알고리즘 또한 노출하지 않도로 노력했습니다. 아래와 같이 고전 암호화 기법중 시저\(Caesar\) 를 살펴보면, 각 문자를 알파벳 순서로 세 번째 뒤 문자로 치환하는 방법을 사용하고 있습니다. 여기서 암호키는 아래와 알파벳 매칭 테이블이 되고, 암호화 알고리즘은 평문 알파벳에 대해 세 번째 뒤 알파벳으로 치환하는 것입니다. 시저 알고리즘의 경우 암호키가 유출될 경우, 평문 문자와 암호문 문자의 패턴을 분석하여 암호화 알고리즘을 쉽게 해독할 수 있지만, 고도화된 복잡한 암호화 알고리즘을 사용할 경우, 암호키를 알고 있음에도 해독하기 어려운 경우가 발생할 수 있습니다. 하지만 암호키라 노출되면 암호화 알고리즘이 해독되는 것은 시간 문제이기 때문에 암호키의 노출은 곧 암호화 알고리즘이 노출되는 것을 의미합니다. 

![](../.gitbook/assets/image%20%285%29.png)

현대 암호화 방식은 보안 시스템의 모든 구성 \(보안 아키텍처 및 암호화 알고리즘\)이 모두 공개되어도, 암호문을 통해 평문을 복호화할 수 없어야 하는데, 이를 Kerckhoff 법칙이라고 합니다. 대표적인 예로 비대칭 암호화 방법중 대표적인 RSA 암호화 알고리즘은 모두 공개되어 있지만, 이 알고리즘을 통해 생성된 암호문은 복호화가 불가능 합니다. 여기서 말하는 불가능이 가능한 이유는 수학적인 복잡성에 따라 복호화 시간이 무한대에 가까워 복호화가 사실상 불가능합니다. 

결국 우리는 Kerchoff 법칙을 만족하면서 암호화에 사용될 키를 송/수신자가 안전하게 공유할 수 있는 방법이 필요합니다. 이 방법중 현재 가장 많이 사용되는 암호화 방식은 SSL/TLS 에서 주로 사용하는 RSA 공개키 암호화 방식 입니다.

### PKI \(Public Key Infrastructure\)

공개키 기반의 암호화 알고리즘 중에서 대표적으로 RSA 가 있습니다. RSA 공개키 암호화 방식의 가장 큰 특징은 암호화 키가 공개키\(Public Key\), 개인키\(Private Key\) 하나의 쌍으로 구성되어 있습니다. 일반적으로 송신자가 공개키로 암호화하여 수신자에게 전송하면, 수신자는 개인키로 복호화 하는 방법입니다. 물론 반대로 개인키로 암호화 하고, 공개키로 복호화도 가능합니다. 이러한 한 쌍의 암호화 키를 이용하여 암/복호화하는 방식이 RSA 알고리즘 입니다.

![](../.gitbook/assets/image%20%284%29.png)



현재 웹서비스에서 가장 많이 사용하는 SSL/TLS 통신기법은 대칭키를 RSA 공개키로 암호화 하여 수신자에게 안전하게 전송하고, 수신자는 개인키로 복호화 하여 대칭키를 안전하게 공유할 수 있습니다. 이후 송/수신 되는 모든 웹트래픽은 대칭키로 암/복호하하여 안전한 통신을 제공합니다. 일반적으로 PKI 기반의 알고리즘은 대칭키에 비해 컴퓨팅 연산을 많이 필요로 합니다. 따라서 웹 서비스와 같은 TCP 기반의 HTTP 트래픽이 많은 경우 대칭키 암호화 방식이 PKI 기반의 암호화 알고리즘에 비해 효율적입니다.

### 인증서 \(Certificate\)









